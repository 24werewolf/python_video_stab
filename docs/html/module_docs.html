
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>VidStab Documentation &#8212; vidstab  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Usage Examples" href="usage.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-vidstab">
<span id="vidstab-documentation"></span><h1><code class="docutils literal notranslate"><span class="pre">VidStab</span></code> Documentation<a class="headerlink" href="#module-vidstab" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="vidstab.VidStab">
<em class="property">class </em><code class="descclassname">vidstab.</code><code class="descname">VidStab</code><span class="sig-paren">(</span><em>kp_method='GFTT'</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#vidstab.VidStab" title="Permalink to this definition">¶</a></dt>
<dd><p>A class for stabilizing video files</p>
<p>The VidStab class can be used to stabilize videos using functionality from OpenCV.
Input video is read from file, put through stabilization process, and written to
an output file.</p>
<p>The process calculates optical flow (<code class="docutils literal notranslate"><span class="pre">cv2.calcOpticalFlowPyrLK</span></code>) from frame to frame using
keypoints generated by the keypoint method specified by the user.  The optical flow will
be used to generate frame to frame transformations (<code class="docutils literal notranslate"><span class="pre">cv2.estimateRigidTransform</span></code>).
Transformations will be applied (<code class="docutils literal notranslate"><span class="pre">cv2.warpAffine</span></code>) to stabilize video.</p>
<p>This class is based on the <a class="reference external" href="http://nghiaho.com/?p=2093">work presented by Nghia Ho</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kp_method</strong> – String of the type of keypoint detector to use. Available options:
<code class="docutils literal notranslate"><span class="pre">[&quot;GFTT&quot;,</span> <span class="pre">&quot;BRISK&quot;,</span> <span class="pre">&quot;DENSE&quot;,</span> <span class="pre">&quot;FAST&quot;,</span> <span class="pre">&quot;HARRIS&quot;,</span> <span class="pre">&quot;MSER&quot;,</span> <span class="pre">&quot;ORB&quot;,</span> <span class="pre">&quot;SIFT&quot;,</span> <span class="pre">&quot;SURF&quot;,</span> <span class="pre">&quot;STAR&quot;]</span></code></li>
<li><strong>args</strong> – Positional arguments for keypoint detector.</li>
<li><strong>kwargs</strong> – Keyword arguments for keypoint detector.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>kp_method</strong> – a string naming the keypoint detector being used</li>
<li><strong>kp_detector</strong> – the keypoint detector object being used</li>
<li><strong>trajectory</strong> – a 2d showing the trajectory of the input video</li>
<li><strong>smoothed_trajectory</strong> – a 2d numpy array showing the smoothed trajectory of the input video</li>
<li><strong>transforms</strong> – a 2d numpy array storing the transformations used from frame to frame</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="vidstab.VidStab.plot_trajectory">
<code class="descname">plot_trajectory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vidstab.VidStab.plot_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot video trajectory</p>
<p>Create a plot of the video’s trajectory &amp; smoothed trajectory.
Separate subplots are used to show the x and y trajectory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">tuple of matplotlib objects <code class="docutils literal notranslate"><span class="pre">(Figure,</span> <span class="pre">(AxesSubplot,</span> <span class="pre">AxesSubplot))</span></code></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vidstab</span> <span class="k">import</span> <span class="n">VidStab</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stabilizer</span> <span class="o">=</span> <span class="n">VidStab</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stabilizer</span><span class="o">.</span><span class="n">gen_transforms</span><span class="p">(</span><span class="n">input_path</span><span class="o">=</span><span class="s1">&#39;input_video.mov&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stabilizer</span><span class="o">.</span><span class="n">plot_trajectory</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vidstab.VidStab.plot_transforms">
<code class="descname">plot_transforms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#vidstab.VidStab.plot_transforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot stabilizing transforms</p>
<p>Create a plot of the transforms used to stabilize the input video.
Plots x &amp; y transforms (dx &amp; dy) in a separate subplot than angle transforms (da).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">tuple of matplotlib objects <code class="docutils literal notranslate"><span class="pre">(Figure,</span> <span class="pre">(AxesSubplot,</span> <span class="pre">AxesSubplot))</span></code></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vidstab</span> <span class="k">import</span> <span class="n">VidStab</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stabilizer</span> <span class="o">=</span> <span class="n">VidStab</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stabilizer</span><span class="o">.</span><span class="n">gen_transforms</span><span class="p">(</span><span class="n">input_path</span><span class="o">=</span><span class="s1">&#39;input_video.mov&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stabilizer</span><span class="o">.</span><span class="n">plot_transforms</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="vidstab.VidStab.stabilize">
<code class="descname">stabilize</code><span class="sig-paren">(</span><em>input_path</em>, <em>output_path</em>, <em>smoothing_window=30</em>, <em>max_frames=inf</em>, <em>border_type='black'</em>, <em>border_size=0</em>, <em>layer_func=None</em>, <em>playback=False</em>, <em>use_stored_transforms=False</em>, <em>show_progress=True</em>, <em>output_fourcc='MJPG'</em><span class="sig-paren">)</span><a class="headerlink" href="#vidstab.VidStab.stabilize" title="Permalink to this definition">¶</a></dt>
<dd><p>read video, perform stabilization, &amp; write output to file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input_path</strong> – Path to input video to stabilize.
Will be read with <code class="docutils literal notranslate"><span class="pre">cv2.VideoCapture</span></code>; see opencv documentation for more info.</li>
<li><strong>output_path</strong> – Path to save stabilized video.
Will be written with <code class="docutils literal notranslate"><span class="pre">cv2.VideoWriter</span></code>; see opencv documentation for more info.</li>
<li><strong>smoothing_window</strong> – window size to use when smoothing trajectory</li>
<li><strong>max_frames</strong> – The maximum amount of frames to stabilize/process.
The list of available codes can be found in fourcc.org.
See cv2.VideoWriter_fourcc documentation for more info.</li>
<li><strong>border_type</strong> – How to handle border when rotations are needed to stabilize.
Options: <code class="docutils literal notranslate"><span class="pre">['black',</span> <span class="pre">'reflect',</span> <span class="pre">'replicate']</span></code></li>
<li><strong>border_size</strong> – size of border in output</li>
<li><strong>layer_func</strong> – Function to layer frames in output.
The function should accept 2 parameters: foreground &amp; background.
The current frame of video will be passed as foreground,
the previous frame will be passed as the background
(after the first frame of output the background will be the output of
layer_func on the last iteration)</li>
<li><strong>use_stored_transforms</strong> – should stored transforms from last stabilization be used instead of
recalculating them?</li>
<li><strong>playback</strong> – Should the a comparison of input video/output video be played back during process?</li>
<li><strong>show_progress</strong> – Should a progress bar be displayed to console?</li>
<li><strong>output_fourcc</strong> – FourCC is a 4-byte code used to specify the video codec.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Nothing is returned.  Output of stabilization is written to <code class="docutils literal notranslate"><span class="pre">output_path</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">vidstab.VidStab</span> <span class="k">import</span> <span class="n">VidStab</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stabilizer</span> <span class="o">=</span> <span class="n">VidStab</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stabilizer</span><span class="o">.</span><span class="n">stabilize</span><span class="p">(</span><span class="n">input_path</span><span class="o">=</span><span class="s1">&#39;input_video.mov&#39;</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="s1">&#39;stable_video.avi&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stabilizer</span> <span class="o">=</span> <span class="n">VidStab</span><span class="p">(</span><span class="n">kp_method</span> <span class="o">=</span> <span class="s1">&#39;ORB&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stabilizer</span><span class="o">.</span><span class="n">stabilize</span><span class="p">(</span><span class="n">input_path</span><span class="o">=</span><span class="s1">&#39;input_video.mov&#39;</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="s1">&#39;stable_video.avi&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="usage.html" title="previous chapter">Usage Examples</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/module_docs.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Adam Spannbauer.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="_sources/module_docs.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>